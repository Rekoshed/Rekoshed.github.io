
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width">
		<title>PhP продвинутый материал</title>
		  <link  href="../../Design/script.css" rel="stylesheet">
		  <link  href="../../Design/toolbar.css" rel="stylesheet">
		  <script src ="../../Design/bild.js"></script>
		  </head>
     <body>
	     <script>
	 		toolbar('../../index.html','../PHP_main.html');
		 </script>
		 
		 <style type="text/css">
		 
		 </style>
			<div class="content php-content">

<header>
            <h1>Как запустить PHP-сервер на Android</h1>
    <hr>
</header>
В статье идет речь о полноценном Web-сервере, который можно очень быстро и гибко настроить под свои нужды. Такие вещи как Composer, .htaccess, php.ini будут работать.<br><br><span class="tag-b">Содержание</span><br><br>1 Termux<br>2 Рабочее место<br>3 Настройка Apache2<br><br><span class="tag-b">1 Termux</span><br><br>Начать разработку PHP- или Web-приложения легко.<br>Вам понадобится приложение Termux, скачать его можно из <a href="https://play.google.com/store/apps/details?id=com.termux">Play Store</a>,
<br>Запустите его и первым делом добавьте виртуальные функциональные кнопки (CTRL, ESC, стрелки) зажав кнопку громкости вверх и букву Q на клавиатуре.
<br>Получится так:
<br><a title="приложение Termux с виртуальными кнопками" alt="приложение Termux с виртуальными кнопками" href="https://annimon.com/ablogs/file1343/Screenshot_20190108-015712.png"><img style="margin:5px;max-width: 480px;" src="https://annimon.com/ablogs/imcache/screenshot_20190108-015712.png.141x250.png"></a>
<br><br>Установите текстовый редактор <span class="tag-i">nano</span>, сервер <span class="tag-i">apache2</span>, <span class="tag-i">php</span> и модуль Apache <span class="tag-i">php-apache</span>. Для потверждения может потребоваться ввести <span class="tag-i">Y</span>.<br>Для этого введите команду в Termux:<br><div class="backcode"><div class="bash" style="font-family:monospace;"><ol><li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">pkg <span style="color: #0000E6; font-weight: bold;">install</span> <span style="color: #0000E6; font-weight: bold;">nano</span> apache2 php php-apache</div></span></li>
</ol></div></div>И откройте доступ к памяти телефона через Termux:<br><div class="backcode"><div class="bash" style="font-family:monospace;"><ol><li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">termux-setup-storage</div></span></li>
</ol></div></div>А так же разрешите приложению работать с памятью телефона.<br><br><span class="tag-b">2 Рабочее место</span><br><br>Это папка в которой будут хранится логи, настройки и папка с сайтом. <br><br>Откройте память телефона, в Termux:<br><div class="backcode"><div class="bash" style="font-family:monospace;"><ol><li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #0000E6; font-weight: bold;">cd</span> ~<span style="color: #000000; font-weight: bold;">/</span>storage<span style="color: #000000; font-weight: bold;">/</span>shared</div></span></li>
</ol></div></div>Создайте папку <span class="tag-i">web</span> - это будет корень всего, что связано с сервером. В корне создайте папки <span class="tag-i">cfg</span> - для настроек (php.ini например), <span class="tag-i">log</span> - для логов сервера и php, <span class="tag-i">tmp</span> - для временных файлов и <span class="tag-i">root</span> - файлы сайта.<br><div class="backcode"><div class="bash" style="font-family:monospace;"><ol><li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #0000E6; font-weight: bold;">mkdir</span> web web<span style="color: #000000; font-weight: bold;">/</span>cfg web<span style="color: #000000; font-weight: bold;">/</span>log web<span style="color: #000000; font-weight: bold;">/</span>tmp web<span style="color: #000000; font-weight: bold;">/</span>root</div></span></li>
</ol></div></div>Можете назвать иначе.<br><br>Теперь через любой файлменеджер откройте папку web/root и создайте там index.php со следующим содержимым:<br><div class="backcode"><div class="php" style="font-family:monospace;"><ol><li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #000000; font-weight: bold;">&lt;?php</span></div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">&nbsp;</div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #009600;">phpinfo</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: green;">;</span></div></span></li>
</ol></div></div>Для проверки достаточно, рабочее окружение создано.<br><br><span class="tag-b">Настройка Apache2</span><br><br>Узнайте полный путь к папке <span class="tag-i">web</span> через ее свойства и запомните его. Везде, где увидите по тексту статьи надпись <span class="tag-b">{$WEB}</span>, заменяйте ее на значение пути. Например, у меня он <span class="tag-i">/storage/emulated/0/web</span><br><br>Откройте папку настроек <span class="tag-i">apache2</span> в Termux, чтобы настроить сервер:<br><div class="backcode"><div class="bash" style="font-family:monospace;"><ol><li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #0000E6; font-weight: bold;">cd</span> ~</div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #0000E6; font-weight: bold;">cd</span> ..</div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #0000E6; font-weight: bold;">cd</span> usr<span style="color: #000000; font-weight: bold;">/</span>etc<span style="color: #000000; font-weight: bold;">/</span>apache2</div></span></li>
</ol></div></div>и начните его редактировать:<br><div class="backcode"><div class="bash" style="font-family:monospace;"><ol><li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #0000E6; font-weight: bold;">nano</span> httpd.conf</div></span></li>
</ol></div></div>Изменить необходимо следующие параметры:<br><div class="backcode"><div class="php" style="font-family:monospace;"><div style="background-color: #FAFAFA;border-bottom: 1px solid #CCC;padding:3px;font-size: 0.8em;"><a>[копировать]</a> <a>[скачать]</a></div><ol><li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #969696;"># порт сервера, можно свой</span></div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">Listen <span style="color: #e02929;">8080</span> </div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">&nbsp;</div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #969696;"># раскоментируйте, чтобы можно было использовать Rewrite Engine</span></div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">LoadModule rewrite_module libexec<span style="color: green;">/</span>apache2<span style="color: green;">/</span>mod_rewrite<span style="color: green;">.</span>so</div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">&nbsp;</div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #969696;"># допишите, чтобы работал php</span></div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">LoadModule php7_module libexec<span style="color: green;">/</span>apache2<span style="color: green;">/</span>libphp7<span style="color: green;">.</span>so</div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">AddHandler application<span style="color: green;">/</span>x<span style="color: green;">-</span>httpd<span style="color: green;">-</span>php <span style="color: green;">.</span>php</div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">PhpIniDir <span style="color: #CE7B00;">"<span style="color: #cc0000;">{$WEB}</span>/cfg"</span></div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">&nbsp;</div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #969696;"># имя сервера, оставьте лучше таким, 8080 - значение Listen</span></div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">SeverName localhost<span style="color: green;">:</span><span style="color: #e02929;">8080</span></div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">&nbsp;</div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #969696;"># корень сайта</span></div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">DocumentRoot <span style="color: #CE7B00;">"<span style="color: #cc0000;">{$WEB}</span>/root"</span></div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">&nbsp;</div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #969696;"># параметры для корня</span></div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: green;">&lt;</span>Directory <span style="color: #CE7B00;">"<span style="color: #cc0000;">{$WEB}</span>/root"</span><span style="color: green;">&gt;</span></div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">&nbsp; &nbsp; <span style="color: #969696;"># измените только этот параметр внутри тега</span></div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"> &nbsp; &nbsp;AllowOverride All</div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: green;">&lt;/</span>Directory<span style="color: green;">&gt;</span></div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">&nbsp;</div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #969696;"># файл index</span></div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">DirectoryIndex index<span style="color: green;">.</span>php</div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">&nbsp;</div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #969696;"># где хранить лог ошибок Apache</span></div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">ErrorLog <span style="color: #CE7B00;">"<span style="color: #cc0000;">{$WEB}</span>/log/apache-error.log"</span></div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">&nbsp;</div></span></li>
<li class="codeline2" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;"><span style="color: #969696;"># где хранить лог запросов к серверу</span></div></span></li>
<li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">CustomLog <span style="color: #CE7B00;">"<span style="color: #cc0000;">{$WEB}</span>/log/apache-access.log"</span> common</div></span></li>
</ol></div></div>Чтобы сохранить в nano используйте CTRL+O, и чтобы закрыть - CTRL+X.<br><br>Подробнее о <span class="tag-b">PhpIniDir</span>. По этому пути модуль PHP будет искать php.ini, если вам нужно его изменить, то добавьте туда его. По умолчанию используются стандартные параметры.<br><br>Запускаем Apache2<br><div class="backcode"><div class="bash" style="font-family:monospace;"><ol><li class="codeline1" style="font-weight: bold;"><span class="linetext"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none;">httpd <span style="color: #660033;">-k</span> start</div></span></li>
</ol></div></div>Остановить вместо start пишите stop, а перезапустить - restart. Прошу заметить, что сервер будет работать пока работает Termux, если вы его полностью закроете, сервер остановится. <br><br>Настройка закончена. Вы сделали все правильно и после ввода в адрессной строке браузера <span class="tag-i">localhost:8080</span> увидите информацию о PHP:<br><a title="Страница phpinfo()" alt="Страница phpinfo()" href="https://annimon.com/ablogs/file1344/Screenshot_20190108-030940~2.png"><img style="margin:5px;max-width: 480px;" src="https://annimon.com/ablogs/imcache/screenshot_20190108-0309402.png.250x129.png"></a>
<header>
	        </div>
  
 </body>
</html>